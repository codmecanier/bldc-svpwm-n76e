C51 COMPILER V9.59.0.0   BLDC_WITH_HALL                                                    02/23/2019 10:47:23 PAGE 1   


C51 COMPILER V9.59.0.0, COMPILATION OF MODULE BLDC_WITH_HALL
OBJECT MODULE PLACED IN .\Objects\BLDC with Hall.obj
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE BLDC with Hall.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Lis
                    -tings\BLDC with Hall.lst) TABS(2) OBJECT(.\Objects\BLDC with Hall.obj)

line level    source

   1          #include <N76E003.h>
   2          #include "BLDC with Hall.h"
   3          #include "3PhaseInverter.h"
   4          
   5          bit BLDCReverse = 1;
   6          bit HA,HB,HC;
   7          bit Hall_Mode_60deg = 1;
   8          
   9          unsigned char BLDCSpeed;
  10          
  11          void SetBLDCDirPWM(unsigned char pwm, bit dir)
  12          {
  13   1        BLDCReverse = dir;
  14   1        BLDCSpeed = pwm;
  15   1      }
  16          
  17          bit GetBLDCDirection()
  18          {return BLDCReverse;}
  19          
  20          void UpdateHall() using 2
  21          { 
  22   1        HA = HAPort;
*** ERROR C202 IN LINE 22 OF BLDC with Hall.c: 'P15': undefined identifier
  23   1        HB = HBPort;
*** ERROR C202 IN LINE 23 OF BLDC with Hall.c: 'P13': undefined identifier
  24   1        HC = HCPort;
*** ERROR C202 IN LINE 24 OF BLDC with Hall.c: 'P14': undefined identifier
  25   1      }
  26          
  27          void HallGpioInit()
  28          {
  29   1        P1M1 &= 0XC7;
  30   1        P1M2 &= 0XC7; 
  31   1        TA = 0X0AA;
  32   1        TA = 0X55;
  33   1        SFRS = 1;
  34   1        P1S |= 0X18;
  35   1        TA = 0X0AA;
  36   1        TA = 0X55;
  37   1        SFRS = 0;
  38   1        HAPort = 1;
*** ERROR C202 IN LINE 38 OF BLDC with Hall.c: 'P15': undefined identifier
  39   1        HBPort = 1;
*** ERROR C202 IN LINE 39 OF BLDC with Hall.c: 'P13': undefined identifier
  40   1        HCPort = 1;
*** ERROR C202 IN LINE 40 OF BLDC with Hall.c: 'P14': undefined identifier
  41   1      }
  42          
  43          unsigned char DetermineCurrentElecCycle(bit reverse) using 1
  44          { 
  45   1        if(HAPort)
*** ERROR C202 IN LINE 45 OF BLDC with Hall.c: 'P15': undefined identifier
  46   1        {
  47   2          if(Hall_Mode_60deg ^ HBPort)
C51 COMPILER V9.59.0.0   BLDC_WITH_HALL                                                    02/23/2019 10:47:23 PAGE 2   

*** ERROR C202 IN LINE 47 OF BLDC with Hall.c: 'P13': undefined identifier
  48   2          {
  49   3            if(HCPort)
*** ERROR C202 IN LINE 49 OF BLDC with Hall.c: 'P14': undefined identifier
  50   3            {
  51   4              if(reverse)
  52   4                return 5;
  53   4              else
  54   4                return 3;   
  55   4            }
  56   3            else
  57   3            {
  58   4              if(reverse)
  59   4                return 4;
  60   4              else
  61   4                return 2;
  62   4            }
  63   3          }
  64   2          else
  65   2          {
  66   3            if(HCPort)
*** ERROR C202 IN LINE 66 OF BLDC with Hall.c: 'P14': undefined identifier
  67   3            {
  68   4              return 0;   //error
  69   4            }
  70   3            else
  71   3            {
  72   4              if(reverse)
  73   4                return 3;
  74   4              else
  75   4                return 1;
  76   4            }
  77   3          }
  78   2        }
  79   1        else
  80   1        {
  81   2          if(Hall_Mode_60deg ^ HBPort)
*** ERROR C202 IN LINE 81 OF BLDC with Hall.c: 'P13': undefined identifier
  82   2          {
  83   3            if(HCPort)
*** ERROR C202 IN LINE 83 OF BLDC with Hall.c: 'P14': undefined identifier
  84   3            {
  85   4              if(reverse)
  86   4                return 6;
  87   4              else
  88   4                return 4;
  89   4            }
  90   3            else
  91   3            {
  92   4              return 0; //error
  93   4            }
  94   3          }
  95   2          else
  96   2          {
  97   3            if(HCPort)
*** ERROR C202 IN LINE 97 OF BLDC with Hall.c: 'P14': undefined identifier
  98   3            {
  99   4              if(reverse)
 100   4                return 1;
 101   4              else
 102   4                return 5;     
 103   4            }
C51 COMPILER V9.59.0.0   BLDC_WITH_HALL                                                    02/23/2019 10:47:23 PAGE 3   

 104   3            else
 105   3            {
 106   4              if(reverse)
 107   4                return 2;
 108   4              else
 109   4                return 6; 
 110   4            }
 111   3          }
 112   2        }
 113   1        return 0;
 114   1      }
 115          
 116          void UpdateBLDCInverter(unsigned char eleccycle) using 1
 117          {
 118   1        EA = 0;
 119   1        switch(eleccycle)
 120   1        {
 121   2          case 1: {     
 122   3            PMEN = 0X30;
 123   3            PWM0L = BLDCSpeed;
 124   3            PWM2L = 0;
 125   3            PWMCON0 |= 0X40;
 126   3            TA = 0X0AA;
 127   3            TA = 0X55;
 128   3            SFRS = 1;
 129   3            PWMINTC=0X10;
 130   3            TA = 0X0AA;
 131   3            TA = 0X55;
 132   3            SFRS = 0;
 133   3            break;
 134   3          }
 135   2          case 2: {
 136   3            PMEN = 0X0C;
 137   3            PWM0L = BLDCSpeed;
 138   3            TA = 0X0AA;
 139   3            TA = 0X55;
 140   3            SFRS = 1;
 141   3            PWM4L = 0;
 142   3            PWMINTC=0X10;
 143   3            TA = 0X0AA;
 144   3            TA = 0X55;
 145   3            SFRS = 0;
 146   3            PWMCON0 |= 0X40;
 147   3            break;
 148   3          }
 149   2          case 3: {
 150   3            PMEN = 0X03;
 151   3            PWM2L = BLDCSpeed;
 152   3            TA = 0X0AA;
 153   3            TA = 0X55;
 154   3            SFRS = 1;
 155   3            PWM4L = 0;
 156   3            PWMINTC=0X12;
 157   3            TA = 0X0AA;
 158   3            TA = 0X55;
 159   3            SFRS = 0;
 160   3            PWMCON0 |= 0X40;
 161   3            break;
 162   3          }
 163   2          case 4: {     
 164   3            PMEN = 0X30;
 165   3            PWM2L = BLDCSpeed;
C51 COMPILER V9.59.0.0   BLDC_WITH_HALL                                                    02/23/2019 10:47:23 PAGE 4   

 166   3            TA = 0X0AA;
 167   3            TA = 0X55;
 168   3            SFRS = 1;
 169   3            PWMINTC=0X12;
 170   3            TA = 0X0AA;
 171   3            TA = 0X55;
 172   3            SFRS = 0;
 173   3            PWM0L = 0;
 174   3            PWMCON0 |= 0X40;
 175   3            break;
 176   3          }
 177   2          case 5: {
 178   3            PMEN = 0X0C;
 179   3            TA = 0X0AA;
 180   3            TA = 0X55;
 181   3            SFRS = 1;
 182   3            PWM4L = BLDCSpeed;
 183   3            PWMINTC=0X14;
 184   3            TA = 0X0AA;
 185   3            TA = 0X55;
 186   3            SFRS = 0;
 187   3            PWM0L = 0;
 188   3            PWMCON0 |= 0X40;
 189   3            break;
 190   3          }
 191   2          case 6: {
 192   3            PMEN = 0X03;
 193   3            TA = 0X0AA;
 194   3            TA = 0X55;
 195   3            SFRS = 1;
 196   3            PWM4L = BLDCSpeed;    
 197   3            PWMINTC=0X14;
 198   3            TA = 0X0AA;
 199   3            TA = 0X55;
 200   3            SFRS = 0;
 201   3            PWM2L = 0;
 202   3            PWMCON0 |= 0X40;
 203   3            break;
 204   3          }
 205   2          case 0:
 206   2            break;
 207   2        }
 208   1        EA = 1;
 209   1      } 

C51 COMPILATION COMPLETE.  0 WARNING(S),  13 ERROR(S)
